<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto Transversal - CONALEP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon SVG de CONALEP -->
    <link rel="icon" type="image/svg+xml" href="images/LogoConalepFavicon.svg">
    
    <!-- Configuración de colores de CONALEP para Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'conalep-green': '#008B48',
                        'conalep-dark': '#012A18',
                        'conalep-accent': '#00A756',
                        'conalep-light': '#F0FDF4',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .bg-main {
             background-color: #011c10; /* Un verde aún más oscuro para el fondo principal */
        }
        .bg-sidebar {
            background-color: #012A18; /* Verde oscuro para la barra lateral */
        }
        .text-main {
            color: #d1fae5; /* Un verde muy claro, casi blanco para el texto */
        }
        .text-accent {
            color: #34d399; /* Verde brillante para acentos y títulos */
        }
        /* Estilos para la barra de desplazamiento */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background-color: #012A18;
        }
        ::-webkit-scrollbar-thumb {
            background-color: #008B48;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: #00A756;
        }
        /* Animación para la aparición del contenido */
        .content-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Clases para el formato del texto generado por IA */
        .prose-custom {
            line-height: 1.7;
            color: #d1fae5;
        }
        .prose-custom h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #a7f3d0;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .prose-custom ul {
            list-style-position: inside;
            padding-left: 0.5rem;
        }
        .prose-custom li {
            margin-bottom: 0.5rem;
        }
        .prose-custom strong {
            color: #f0fdf4;
        }
    </style>
</head>
<body class="h-full flex bg-main text-main">

    <!-- Menú lateral para escritorio -->
    <aside class="w-64 flex-shrink-0 bg-sidebar p-6 hidden md:flex flex-col">
        <div class="flex items-center gap-3 mb-8">
            <!-- Logo CONALEP -->
            <img src="images/LogoConalepFavicon.svg" alt="Logo CONALEP" class="h-10 w-10">
            <h1 class="text-xl font-bold text-white">CONALEP</h1>
        </div>
        <nav id="desktop-nav" class="flex flex-col gap-2">
            <!-- Los enlaces de navegación se insertarán aquí -->
        </nav>
    </aside>

    <!-- Contenedor principal -->
    <div class="flex-1 flex flex-col overflow-hidden">
        <!-- Encabezado para móvil -->
        <header class="md:hidden bg-sidebar/80 backdrop-blur-sm p-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <img src="images/LogoConalepFavicon.svg" alt="Logo CONALEP" class="h-8 w-8">
                <h1 class="text-lg font-bold text-white">CONALEP</h1>
            </div>
            <button id="mobile-menu-button" class="p-2 rounded-md hover:bg-conalep-green">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>
        </header>

        <!-- Menú desplegable para móvil -->
        <div id="mobile-menu" class="hidden md:hidden bg-sidebar p-4">
            <nav id="mobile-nav" class="flex flex-col gap-2">
                <!-- Los enlaces de navegación se insertarán aquí -->
            </nav>
        </div>

        <!-- Área de contenido principal -->
        <main id="content" class="flex-1 overflow-y-auto p-6 md:p-10">
            <!-- El contenido se cargará dinámicamente aquí -->
        </main>
        
        <footer class="text-center p-4 text-xs text-gray-400 border-t border-conalep-dark">
            <p>&copy; 2024 Proyecto Transversal de Signos Vitales. CONALEP. Todos los derechos reservados.</p>
        </footer>
    </div>
    
    <!-- Modal para la Galería de Imágenes -->
    <div id="gallery-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 hidden items-center justify-center p-4">
        <div class="relative max-w-4xl max-h-full">
            <img id="modal-img" src="" alt="Imagen ampliada" class="max-w-full max-h-[90vh] rounded-lg shadow-2xl">
            <button id="close-modal-btn" class="absolute -top-4 -right-4 bg-white text-black rounded-full h-10 w-10 flex items-center justify-center text-2xl font-bold">&times;</button>
            <button id="prev-btn" class="absolute left-4 top-1/2 -translate-y-1/2 bg-white/20 text-white rounded-full h-12 w-12 flex items-center justify-center text-2xl hover:bg-white/30">&lt;</button>
            <button id="next-btn" class="absolute right-4 top-1/2 -translate-y-1/2 bg-white/20 text-white rounded-full h-12 w-12 flex items-center justify-center text-2xl hover:bg-white/30">&gt;</button>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const contentContainer = document.getElementById('content');
            const desktopNav = document.getElementById('desktop-nav');
            const mobileNav = document.getElementById('mobile-nav');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuButton = document.getElementById('mobile-menu-button');

            // --- Definición del contenido y la estructura de navegación ---

            const navLinks = [
                { id: 'home', title: 'Inicio', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>`},
                { title: 'Signos Vitales', isCategory: true },
                { id: 'imc', title: 'IMC', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 1 0 10 10c0-4.42-2.87-8-8-8M12 14v6M12 4v2"/><path d="m15 4-3 3-3-3"/></svg>` },
                { id: 'temperatura', title: 'Temperatura', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></svg>` },
                { id: 'presion', title: 'Presión Arterial', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>` },
                { id: 'altura', title: 'Altura', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20V4"/><path d="m6 10 6-6 6 6"/><path d="M6 20h12"/></svg>` },
                { id: 'peso', title: 'Peso', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M12 16v-4"/><path d="m9 12 3-3 3 3"/></svg>` },
                { id: 'oxigenacion', title: 'Oxigenación', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5C9 10 2 12 2 16a10 10 0 0 0 20 0c0-4-7-6-10-11z"/><path d="M12 18a4 4 0 0 0 4-4h-8a4 4 0 0 0 4 4z"/></svg>` },
                { title: 'Proyecto', isCategory: true },
                { id: 'db', title: 'Bases de Datos', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>` },
                { id: 'gallery', title: 'Galería', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>` },
                { id: 'agradecimientos', title: 'Agradecimientos', icon: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>`},
            ];

            const pages = {
                home: `
                    <div class="content-fade-in">
                        <h2 class="text-4xl font-bold text-white mb-4">Proyecto de Análisis de Signos Vitales</h2>
                        <p class="text-lg text-gray-300 mb-8">Bienvenido al portal del proyecto de análisis estadístico de signos vitales de los grupos 614, 615, 616 y 617 de CONALEP. Este proyecto recopila y visualiza datos para entender mejor los patrones de salud de los estudiantes.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <a href="#imc" class="nav-link-js bg-conalep-dark p-6 rounded-lg hover:bg-conalep-green transition-colors group">
                                <h3 class="text-xl font-semibold text-accent mb-2">Calculadora de IMC con IA</h3>
                                <p class="text-gray-400">Calcula tu IMC y obtén recomendaciones personalizadas por la IA de Gemini.</p>
                            </a>
                            <a href="#temperatura" class="nav-link-js bg-conalep-dark p-6 rounded-lg hover:bg-conalep-green transition-colors group">
                                <h3 class="text-xl font-semibold text-accent mb-2">Conversor de Temperatura</h3>
                                <p class="text-gray-400">Convierte fácilmente temperaturas entre grados Celsius y Fahrenheit.</p>
                            </a>
                             <a href="#gallery" class="nav-link-js bg-conalep-dark p-6 rounded-lg hover:bg-conalep-green transition-colors group">
                                <h3 class="text-xl font-semibold text-accent mb-2">Galería de Evidencias</h3>
                                <p class="text-gray-400">Explora las fotos de la exposición y el trabajo realizado durante el proyecto.</p>
                            </a>
                        </div>
                    </div>
                `,
                imc: `
                    <div class="content-fade-in">
                        <h2 class="text-3xl font-bold text-white mb-6">Índice de Masa Corporal (IMC)</h2>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="bg-conalep-dark p-6 rounded-lg space-y-6">
                                <div>
                                    <h3 class="text-2xl font-semibold text-accent mb-4">Calculadora de IMC</h3>
                                    <div class="space-y-4">
                                        <div>
                                            <label for="weight" class="block text-sm font-medium text-gray-400 mb-1">Peso (kg)</label>
                                            <input type="number" id="weight" class="w-full bg-gray-800 border-gray-700 rounded-md p-2 text-white focus:ring-2 focus:ring-conalep-accent" placeholder="Ej: 70">
                                        </div>
                                        <div>
                                            <label for="height" class="block text-sm font-medium text-gray-400 mb-1">Altura (m)</label>
                                            <input type="number" id="height" class="w-full bg-gray-800 border-gray-700 rounded-md p-2 text-white focus:ring-2 focus:ring-conalep-accent" placeholder="Ej: 1.75">
                                        </div>
                                        <button id="calculate-imc-btn" class="w-full bg-conalep-green text-white font-semibold py-2 rounded-md hover:bg-conalep-accent transition-colors">Calcular</button>
                                    </div>
                                    <div id="imc-result" class="mt-6 text-center"></div>
                                </div>
                                
                                <div id="gemini-imc-section" class="pt-6 border-t border-gray-700 hidden">
                                    <h3 class="text-2xl font-semibold text-green-300 mb-4">Asistente de Salud IA</h3>
                                    <p class="text-gray-400 mb-4">Obtén recomendaciones generales basadas en tu resultado de IMC.</p>
                                    <button id="get-recommendations-btn" class="w-full bg-green-600 text-white font-semibold py-2 rounded-md hover:bg-green-500 transition-colors disabled:bg-gray-600 disabled:cursor-not-allowed">✨ Obtener Recomendaciones</button>
                                    <div id="loading-spinner" class="mt-4 hidden text-center">
                                        <svg class="animate-spin h-8 w-8 text-white mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        <p class="text-gray-400 mt-2">Generando consejos...</p>
                                    </div>
                                    <div id="recommendations-container" class="mt-6 text-left p-4 bg-black/20 rounded-lg hidden prose-custom">
                                        <!-- Recommendations will be injected here -->
                                    </div>
                                </div>

                            </div>
                            <div class="bg-conalep-dark p-6 rounded-lg">
                                <h3 class="text-2xl font-semibold text-accent mb-4">Tabla de Referencia</h3>
                                <img src="https://placehold.co/600x400/012A18/d1fae5?text=Tabla+de+IMC" class="rounded-lg shadow-md w-full">
                            </div>
                        </div>
                    </div>
                `,
                temperatura: `
                    <div class="content-fade-in">
                        <h2 class="text-3xl font-bold text-white mb-6">Temperatura Corporal</h2>
                         <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <div class="bg-conalep-dark p-6 rounded-lg">
                                <h3 class="text-2xl font-semibold text-accent mb-4">Conversor de Temperatura</h3>
                                <div class="space-y-4">
                                    <div>
                                        <label for="celsius" class="block text-sm font-medium text-gray-400 mb-1">Celsius (°C)</label>
                                        <input type="number" id="celsius" class="w-full bg-gray-800 border-gray-700 rounded-md p-2 text-white focus:ring-2 focus:ring-conalep-accent" placeholder="°C">
                                    </div>
                                    <div>
                                        <label for="fahrenheit" class="block text-sm font-medium text-gray-400 mb-1">Fahrenheit (°F)</label>
                                        <input type="number" id="fahrenheit" class="w-full bg-gray-800 border-gray-700 rounded-md p-2 text-white focus:ring-2 focus:ring-conalep-accent" placeholder="°F">
                                    </div>
                                </div>
                                <div id="temp-info" class="mt-6 text-center text-gray-400">La temperatura corporal normal es de aproximadamente 37°C (98.6°F).</div>
                            </div>
                             <div class="bg-conalep-dark p-6 rounded-lg">
                                <h3 class="text-2xl font-semibold text-accent mb-4">Información</h3>
                                <p class="text-gray-400">La temperatura corporal es un indicador clave de la salud. Las desviaciones de la norma pueden indicar fiebre, hipotermia u otras condiciones médicas. Es importante medirla correctamente para un diagnóstico preciso.</p>
                            </div>
                        </div>
                    </div>
                `,
                agradecimientos: `
                    <div class="content-fade-in">
                        <h2 class="text-3xl font-bold text-white mb-6">Agradecimientos</h2>
                        <div class="bg-conalep-dark p-8 rounded-lg space-y-4 text-gray-300">
                            <p>Queremos expresar nuestro más sincero agradecimiento a todas las personas que hicieron posible la realización de este proyecto transversal.</p>
                            <p>A nuestros profesores, por su guía, paciencia y por compartir su invaluable conocimiento en cada etapa del desarrollo.</p>
                            <p>A nuestros compañeros de los grupos 614, 615, 616 y 617, por su participación activa en la recolección de datos y su entusiasmo.</p>
                            <p>Finalmente, un agradecimiento especial a las autoridades de CONALEP por fomentar este tipo de proyectos que nos permiten aplicar lo aprendido en un entorno práctico y colaborativo.</p>
                            <p class="font-semibold text-accent pt-4">¡Gracias a todos!</p>
                        </div>
                    </div>
                `,
                presion: `<div class="content-fade-in"><h2 class="text-3xl font-bold text-white mb-6">Presión Arterial</h2><p class="text-gray-300 mb-6">Datos recopilados sobre la presión arterial.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-conalep-dark p-4 rounded-lg"><img src="https://placehold.co/600x400/012A18/d1fae5?text=Gráfico+Presión" class="rounded-md w-full"></div></div></div>`,
                altura: `<div class="content-fade-in"><h2 class="text-3xl font-bold text-white mb-6">Altura</h2><p class="text-gray-300 mb-6">Datos recopilados sobre la altura.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-conalep-dark p-4 rounded-lg"><img src="https://placehold.co/600x400/012A18/d1fae5?text=Gráfico+Altura" class="rounded-md w-full"></div></div></div>`,
                peso: `<div class="content-fade-in"><h2 class="text-3xl font-bold text-white mb-6">Peso</h2><p class="text-gray-300 mb-6">Datos recopilados sobre el peso.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-conalep-dark p-4 rounded-lg"><img src="https://placehold.co/600x400/012A18/d1fae5?text=Gráfico+Peso" class="rounded-md w-full"></div></div></div>`,
                oxigenacion: `<div class="content-fade-in"><h2 class="text-3xl font-bold text-white mb-6">Oxigenación</h2><p class="text-gray-300 mb-6">Datos recopilados sobre la oxigenación.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-conalep-dark p-4 rounded-lg"><img src="https://placehold.co/600x400/012A18/d1fae5?text=Gráfico+Oxigenación" class="rounded-md w-full"></div></div></div>`,
                db: `<div class="content-fade-in"><h2 class="text-3xl font-bold text-white mb-6">Bases de Datos</h2><p class="text-gray-300 mb-6">Tablas con los datos brutos del proyecto.</p><div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div class="bg-conalep-dark p-4 rounded-lg"><img src="https://placehold.co/600x400/012A18/d1fae5?text=Tabla+de+Datos" class="rounded-md w-full"></div></div></div>`,
                gallery: `
                    <div class="content-fade-in">
                        <h2 class="text-3xl font-bold text-white mb-6">Galería de la Exposición</h2>
                        <p class="text-gray-300 mb-6">Momentos capturados durante la presentación del proyecto.</p>
                        <div id="gallery-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                            ${Array.from({length: 20}, (_, i) => `
                                <div class="bg-conalep-dark rounded-lg overflow-hidden group aspect-square">
                                    <img src="https://placehold.co/400x400/012A18/d1fae5?text=Expo+${i + 1}" 
                                         alt="Foto de la exposición ${i + 1}" 
                                         class="w-full h-full object-cover cursor-pointer group-hover:scale-105 transition-transform duration-300"
                                         data-index="${i}">
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `
            };
            
            const galleryImages = Array.from({length: 20}, (_, i) => `https://placehold.co/800x600/011c10/d1fae5?text=Expo+${i + 1}`);
            let currentImageIndex = 0;

            // --- Lógica de la API de Gemini ---
            
            async function callGeminiAPI(prompt) {
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                const payload = { contents: [{ parts: [{ text: prompt }] }] };
                let retries = 3, delay = 1000;
                while (retries > 0) {
                    try {
                        const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                        if (response.ok) {
                            const result = await response.json();
                            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;
                            if (text) return text;
                            throw new Error("Invalid API response.");
                        }
                        throw new Error(`API request failed with status ${response.status}`);
                    } catch (error) {
                        console.error("Error calling Gemini API:", error);
                        retries--;
                        if (retries === 0) return "Lo siento, no pude generar recomendaciones en este momento. Por favor, inténtalo de nuevo más tarde.";
                        await new Promise(res => setTimeout(res, delay));
                        delay *= 2;
                    }
                }
            }
            
            async function getIMCRecommendations() {
                const btn = document.getElementById('get-recommendations-btn');
                const recommendationsContainer = document.getElementById('recommendations-container');
                const loadingSpinner = document.getElementById('loading-spinner');
                const { imc, category } = btn.dataset;
                if (!imc || !category) return;
                btn.disabled = true;
                loadingSpinner.classList.remove('hidden');
                recommendationsContainer.classList.add('hidden');
                const prompt = `Actúa como un asesor de salud amigable y motivador. Un usuario ha calculado su Índice de Masa Corporal (IMC) y ha obtenido un valor de ${imc}, lo que lo clasifica como '${category}'. Proporciona recomendaciones generales de salud en español, divididas en las siguientes secciones: 1. **Alimentación:** Ofrece consejos prácticos y sencillos sobre nutrición. 2. **Actividad Física:** Sugiere tipos de ejercicio apropiados. 3. **Bienestar General:** Incluye consejos sobre hidratación, sueño o manejo del estrés. Mantén un tono positivo y alentador. No uses lenguaje demasiado técnico. IMPORTANTE: Finaliza siempre con el siguiente descargo de responsabilidad: 'Recuerda que estas son recomendaciones generales y no sustituyen el consejo de un profesional de la salud. Consulta a un médico o nutricionista para un plan personalizado.' Formatea la respuesta usando etiquetas HTML simples: usa <h3> para los títulos de las secciones y <ul> con <li> para las listas de consejos. No incluyas \`\`\`html o markdown.`;
                const recommendations = await callGeminiAPI(prompt);
                recommendationsContainer.innerHTML = recommendations;
                loadingSpinner.classList.add('hidden');
                recommendationsContainer.classList.remove('hidden');
            }

            function renderNav() {
                let navHTML = '';
                navLinks.forEach(link => {
                    if (link.isCategory) {
                        navHTML += `<h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider mt-4 mb-1 px-3">${link.title}</h3>`;
                    } else {
                        navHTML += `<a href="#${link.id}" class="nav-link-js flex items-center gap-3 px-3 py-2 rounded-md text-gray-300 hover:bg-conalep-green hover:text-white transition-colors" data-page="${link.id}">${link.icon}<span class="font-medium">${link.title}</span></a>`;
                    }
                });
                desktopNav.innerHTML = navHTML;
                mobileNav.innerHTML = navHTML;
            }

            function setActiveLink(pageId) {
                document.querySelectorAll('.nav-link-js').forEach(link => {
                    link.classList.toggle('bg-conalep-green', link.dataset.page === pageId);
                    link.classList.toggle('text-white', link.dataset.page === pageId);
                });
            }

            function loadContent(pageId) {
                if (pages[pageId]) {
                    contentContainer.innerHTML = pages[pageId];
                    setActiveLink(pageId);
                    addEventListenersForPage(pageId);
                    contentContainer.scrollTop = 0;
                }
            }

            function handleNavigation(event) {
                const link = event.target.closest('.nav-link-js');
                if (link) {
                    event.preventDefault();
                    const pageId = link.getAttribute('href').substring(1);
                    window.location.hash = pageId;
                    if (!mobileMenu.classList.contains('hidden')) {
                        mobileMenu.classList.add('hidden');
                    }
                }
            }

            function handleHashChange() {
                const pageId = window.location.hash.substring(1) || 'home';
                loadContent(pageId);
            }
            
            function addEventListenersForPage(pageId) {
                if (pageId === 'imc') {
                    document.getElementById('calculate-imc-btn').addEventListener('click', calculateIMC);
                    document.getElementById('get-recommendations-btn').addEventListener('click', getIMCRecommendations);
                }
                if (pageId === 'temperatura') {
                    document.getElementById('celsius').addEventListener('input', () => convertTemp('c_to_f'));
                    document.getElementById('fahrenheit').addEventListener('input', () => convertTemp('f_to_c'));
                }
                if(pageId === 'gallery') {
                    document.getElementById('gallery-grid').addEventListener('click', openModal);
                }
            }
            
            function calculateIMC() {
                const weight = parseFloat(document.getElementById('weight').value);
                const height = parseFloat(document.getElementById('height').value);
                const resultDiv = document.getElementById('imc-result');
                const geminiSection = document.getElementById('gemini-imc-section');
                const recommendationsBtn = document.getElementById('get-recommendations-btn');
                
                if (isNaN(weight) || isNaN(height) || weight <= 0 || height <= 0) {
                    resultDiv.innerHTML = `<p class="text-red-400">Por favor, introduce valores válidos.</p>`;
                    geminiSection.classList.add('hidden');
                    return;
                }
                const imc = weight / (height * height);
                let category = '', colorClass = '';
                if (imc < 18.5) { category = 'Bajo peso'; colorClass = 'text-yellow-400'; } 
                else if (imc < 25) { category = 'Peso normal'; colorClass = 'text-green-400'; } 
                else if (imc < 30) { category = 'Sobrepeso'; colorClass = 'text-orange-400'; } 
                else { category = 'Obesidad'; colorClass = 'text-red-400'; }
                resultDiv.innerHTML = `<p class="text-lg text-gray-400">Tu IMC es</p><p class="text-4xl font-bold ${colorClass}">${imc.toFixed(2)}</p><p class="text-lg font-medium ${colorClass}">${category}</p>`;
                geminiSection.classList.remove('hidden');
                recommendationsBtn.disabled = false;
                recommendationsBtn.dataset.imc = imc.toFixed(2);
                recommendationsBtn.dataset.category = category;
                document.getElementById('recommendations-container').classList.add('hidden');
            }

            function convertTemp(direction) {
                 const celsiusInput = document.getElementById('celsius');
                 const fahrenheitInput = document.getElementById('fahrenheit');
                if (direction === 'c_to_f') {
                    const celsius = parseFloat(celsiusInput.value);
                    fahrenheitInput.value = isNaN(celsius) ? '' : ((celsius * 9/5) + 32).toFixed(2);
                } else {
                    const fahrenheit = parseFloat(fahrenheitInput.value);
                    celsiusInput.value = isNaN(fahrenheit) ? '' : ((fahrenheit - 32) * 5/9).toFixed(2);
                }
            }
            
            const modal = document.getElementById('gallery-modal');
            const modalImg = document.getElementById('modal-img');
            function showImage(index) {
                currentImageIndex = (index + galleryImages.length) % galleryImages.length;
                modalImg.src = galleryImages[currentImageIndex];
            }
            function openModal(e) {
                if (e.target.tagName === 'IMG') {
                    showImage(parseInt(e.target.dataset.index));
                    modal.classList.remove('hidden');
                    modal.classList.add('flex');
                }
            }
            function closeModal() {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }

            mobileMenuButton.addEventListener('click', () => mobileMenu.classList.toggle('hidden'));
            document.body.addEventListener('click', handleNavigation);
            window.addEventListener('hashchange', handleHashChange);
            document.getElementById('close-modal-btn').addEventListener('click', closeModal);
            document.getElementById('prev-btn').addEventListener('click', () => showImage(currentImageIndex - 1));
            document.getElementById('next-btn').addEventListener('click', () => showImage(currentImageIndex + 1));
            renderNav();
            handleHashChange();
        });
    </script>
</body>
</html>
